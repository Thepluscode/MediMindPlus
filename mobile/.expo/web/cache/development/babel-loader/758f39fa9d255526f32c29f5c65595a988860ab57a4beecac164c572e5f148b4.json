{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { aiBlockchainService } from \"../../services/aiBlockchainService\";\nvar initialState = {\n  anomalies: [],\n  unresolvedCount: 0,\n  criticalCount: 0,\n  isLoading: false,\n  error: null,\n  lastUpdated: null\n};\nexport var getPatientAnomalies = createAsyncThunk('anomaly/getPatientAnomalies', function () {\n  var _ref2 = _asyncToGenerator(function* (patientDID, _ref) {\n    var rejectWithValue = _ref.rejectWithValue;\n    try {\n      var anomalies = yield aiBlockchainService.getPatientAnomalies(patientDID);\n      return anomalies;\n    } catch (error) {\n      return rejectWithValue(error.message || 'Failed to get anomalies');\n    }\n  });\n  return function (_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nexport var detectAnomaly = createAsyncThunk('anomaly/detectAnomaly', function () {\n  var _ref5 = _asyncToGenerator(function* (_ref3, _ref4) {\n    var deviceId = _ref3.deviceId,\n      patientDID = _ref3.patientDID,\n      sensorData = _ref3.sensorData;\n    var rejectWithValue = _ref4.rejectWithValue;\n    try {\n      var anomaly = yield aiBlockchainService.detectAnomaly(deviceId, patientDID, sensorData);\n      return anomaly;\n    } catch (error) {\n      return rejectWithValue(error.message || 'Failed to detect anomaly');\n    }\n  });\n  return function (_x3, _x4) {\n    return _ref5.apply(this, arguments);\n  };\n}());\nvar anomalySlice = createSlice({\n  name: 'anomaly',\n  initialState: initialState,\n  reducers: {\n    clearAnomalyError: function clearAnomalyError(state) {\n      state.error = null;\n    },\n    resetAnomalies: function resetAnomalies(state) {\n      state.anomalies = [];\n      state.unresolvedCount = 0;\n      state.criticalCount = 0;\n      state.error = null;\n      state.lastUpdated = null;\n    },\n    updateAnomalyCounts: function updateAnomalyCounts(state) {\n      state.unresolvedCount = state.anomalies.filter(function (a) {\n        return !a.resolved;\n      }).length;\n      state.criticalCount = state.anomalies.filter(function (a) {\n        return a.severity === 'critical' && !a.resolved;\n      }).length;\n    }\n  },\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(getPatientAnomalies.pending, function (state) {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(getPatientAnomalies.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.anomalies = action.payload;\n      state.unresolvedCount = action.payload.filter(function (a) {\n        return !a.resolved;\n      }).length;\n      state.criticalCount = action.payload.filter(function (a) {\n        return a.severity === 'critical' && !a.resolved;\n      }).length;\n      state.lastUpdated = new Date().toISOString();\n    }).addCase(getPatientAnomalies.rejected, function (state, action) {\n      state.isLoading = false;\n      state.error = action.payload || 'Failed to get anomalies';\n    }).addCase(detectAnomaly.pending, function (state) {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(detectAnomaly.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.anomalies.unshift(action.payload);\n      state.unresolvedCount = state.anomalies.filter(function (a) {\n        return !a.resolved;\n      }).length;\n      state.criticalCount = state.anomalies.filter(function (a) {\n        return a.severity === 'critical' && !a.resolved;\n      }).length;\n      state.lastUpdated = new Date().toISOString();\n    }).addCase(detectAnomaly.rejected, function (state, action) {\n      state.isLoading = false;\n      state.error = action.payload || 'Failed to detect anomaly';\n    });\n  }\n});\nvar _anomalySlice$actions = anomalySlice.actions,\n  clearAnomalyError = _anomalySlice$actions.clearAnomalyError,\n  resetAnomalies = _anomalySlice$actions.resetAnomalies,\n  updateAnomalyCounts = _anomalySlice$actions.updateAnomalyCounts;\nexport { clearAnomalyError, resetAnomalies, updateAnomalyCounts };\nexport var selectAnomalies = function selectAnomalies(state) {\n  return state.anomaly.anomalies;\n};\nexport var selectUnresolvedCount = function selectUnresolvedCount(state) {\n  return state.anomaly.unresolvedCount;\n};\nexport var selectCriticalCount = function selectCriticalCount(state) {\n  return state.anomaly.criticalCount;\n};\nexport var selectAnomalyIsLoading = function selectAnomalyIsLoading(state) {\n  return state.anomaly.isLoading;\n};\nexport var selectAnomalyError = function selectAnomalyError(state) {\n  return state.anomaly.error;\n};\nexport var selectAnomalyLastUpdated = function selectAnomalyLastUpdated(state) {\n  return state.anomaly.lastUpdated;\n};\nexport default anomalySlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","aiBlockchainService","initialState","anomalies","unresolvedCount","criticalCount","isLoading","error","lastUpdated","getPatientAnomalies","_ref2","_asyncToGenerator","patientDID","_ref","rejectWithValue","message","_x","_x2","apply","arguments","detectAnomaly","_ref5","_ref3","_ref4","deviceId","sensorData","anomaly","_x3","_x4","anomalySlice","name","reducers","clearAnomalyError","state","resetAnomalies","updateAnomalyCounts","filter","a","resolved","length","severity","extraReducers","builder","addCase","pending","fulfilled","action","payload","Date","toISOString","rejected","unshift","_anomalySlice$actions","actions","selectAnomalies","selectUnresolvedCount","selectCriticalCount","selectAnomalyIsLoading","selectAnomalyError","selectAnomalyLastUpdated","reducer"],"sources":["/Users/theophilusogieva/Desktop/MediMindPlus/MediMindPlus/frontend/src/store/slices/anomalySlice.ts"],"sourcesContent":["import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { aiBlockchainService, AnomalyDetection } from '../../services/aiBlockchainService';\nimport type { RootState } from '../types';\n\ninterface AnomalyState {\n  anomalies: AnomalyDetection[];\n  unresolvedCount: number;\n  criticalCount: number;\n  isLoading: boolean;\n  error: string | null;\n  lastUpdated: string | null;\n}\n\nconst initialState: AnomalyState = {\n  anomalies: [],\n  unresolvedCount: 0,\n  criticalCount: 0,\n  isLoading: false,\n  error: null,\n  lastUpdated: null,\n};\n\n// Async thunks\nexport const getPatientAnomalies = createAsyncThunk<\n  AnomalyDetection[],\n  string, // patientDID\n  { rejectValue: string }\n>(\n  'anomaly/getPatientAnomalies',\n  async (patientDID, { rejectWithValue }) => {\n    try {\n      const anomalies = await aiBlockchainService.getPatientAnomalies(patientDID);\n      return anomalies;\n    } catch (error: any) {\n      return rejectWithValue(error.message || 'Failed to get anomalies');\n    }\n  }\n);\n\nexport const detectAnomaly = createAsyncThunk<\n  AnomalyDetection,\n  { deviceId: string; patientDID: string; sensorData: any },\n  { rejectValue: string }\n>(\n  'anomaly/detectAnomaly',\n  async ({ deviceId, patientDID, sensorData }, { rejectWithValue }) => {\n    try {\n      const anomaly = await aiBlockchainService.detectAnomaly(deviceId, patientDID, sensorData);\n      return anomaly;\n    } catch (error: any) {\n      return rejectWithValue(error.message || 'Failed to detect anomaly');\n    }\n  }\n);\n\nconst anomalySlice = createSlice({\n  name: 'anomaly',\n  initialState,\n  reducers: {\n    clearAnomalyError: (state) => {\n      state.error = null;\n    },\n    resetAnomalies: (state) => {\n      state.anomalies = [];\n      state.unresolvedCount = 0;\n      state.criticalCount = 0;\n      state.error = null;\n      state.lastUpdated = null;\n    },\n    updateAnomalyCounts: (state) => {\n      state.unresolvedCount = state.anomalies.filter(a => !a.resolved).length;\n      state.criticalCount = state.anomalies.filter(a => a.severity === 'critical' && !a.resolved).length;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      // Get patient anomalies\n      .addCase(getPatientAnomalies.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(getPatientAnomalies.fulfilled, (state, action: PayloadAction<AnomalyDetection[]>) => {\n        state.isLoading = false;\n        state.anomalies = action.payload;\n        state.unresolvedCount = action.payload.filter(a => !a.resolved).length;\n        state.criticalCount = action.payload.filter(a => a.severity === 'critical' && !a.resolved).length;\n        state.lastUpdated = new Date().toISOString();\n      })\n      .addCase(getPatientAnomalies.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.payload || 'Failed to get anomalies';\n      })\n      // Detect anomaly\n      .addCase(detectAnomaly.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(detectAnomaly.fulfilled, (state, action: PayloadAction<AnomalyDetection>) => {\n        state.isLoading = false;\n        state.anomalies.unshift(action.payload);\n        state.unresolvedCount = state.anomalies.filter(a => !a.resolved).length;\n        state.criticalCount = state.anomalies.filter(a => a.severity === 'critical' && !a.resolved).length;\n        state.lastUpdated = new Date().toISOString();\n      })\n      .addCase(detectAnomaly.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.payload || 'Failed to detect anomaly';\n      });\n  },\n});\n\nexport const {\n  clearAnomalyError,\n  resetAnomalies,\n  updateAnomalyCounts,\n} = anomalySlice.actions;\n\n// Selectors\nexport const selectAnomalies = (state: RootState) => state.anomaly.anomalies;\nexport const selectUnresolvedCount = (state: RootState) => state.anomaly.unresolvedCount;\nexport const selectCriticalCount = (state: RootState) => state.anomaly.criticalCount;\nexport const selectAnomalyIsLoading = (state: RootState) => state.anomaly.isLoading;\nexport const selectAnomalyError = (state: RootState) => state.anomaly.error;\nexport const selectAnomalyLastUpdated = (state: RootState) => state.anomaly.lastUpdated;\n\nexport default anomalySlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}